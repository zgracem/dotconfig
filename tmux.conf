# -----------------------------------------------------------------------------
# ~zozo/.config/tmux.conf
# say hello: printf "zozo\x40inescapable\x2eorg"
# -----------------------------------------------------------------------------

set -g default-terminal screen-256color
set -g default-command $SHELL

set -g history-limit 4096

# enable system clipboard for OS X
if-shell '[[ $OSTYPE =~ darwin* ]]' 'set-option -g default-command "reattach-to-user-namespace -l $SHELL"'

# window numbering starts at 0
set -g base-index 0

# set the esc/alt disambiguation timeout to 50ms
set -sg escape-time 50

# xterm keys
setw -g xterm-keys on

# pass the xterm window title through
set -g set-titles off
set -g set-titles-string '#T'

# 24-hour clock
set -g clock-mode-style 24
set -g clock-mode-colour white

# prevent tmux 1.8 from crashing Prompt (iOS SSH app)
set -g terminal-overrides ",*:XT@"

# renumber windows sequentially after closing one
set -g renumber-windows on

# constrain window size to the maximum size of any client connected to it
setw -g aggressive-resize on

# -----------------------------------------------------------------------------
# Notifications
# -----------------------------------------------------------------------------

# shut up
set -g bell-on-alert off

# only pay attention to bells in current window
set -g bell-action current

# display status line messages etc. for 1s
set -g display-time 1000

# window notifications
set -g visual-activity on
# setw -g monitor-activity on

# -----------------------------------------------------------------------------
# Keybindings
# -----------------------------------------------------------------------------

# use ^A as the prefix key
unbind C-b
set -g prefix C-a
bind a send-prefix

# use vi keybindings in copy mode
setw -g mode-keys vi

# 'v' begins selection (as in vim)
bind-key -t vi-copy v begin-selection

# 'Enter' also uses copy-pipe
unbind -t vi-copy Enter

# copying uses system pasteboard
# bind-key -t vi-copy y copy-pipe "reattach-to-user-namespace pbcopy"
# bind-key -t vi-copy Enter copy-pipe "reattach-to-user-namespace pbcopy"

# custom keybindings

bind C-a last-window
bind C-d detach
bind C-r source-file ~/.tmux.conf \; display-message "Reloaded ~/.tmux.conf"
bind C-w kill-window
bind C-q kill-session

bind | split-window -h
bind _ split-window -v

# vim-style pane selection
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# open man page with /
# https://github.com/kooothor/.dotfiles/blob/master/tmux.conf
bind / command-prompt "split-window -h 'exec man %%'"

bind M new-window -n alpine "alpine $flags_alpine"
bind T new-window -n transmission "$dir_mybin/transmission-remote-cli/transmission-remote-cli"

# -----------------------------------------------------------------------------
# Mouse
# -----------------------------------------------------------------------------

# mouse enters copy mode
setw -g mode-mouse on

# mouse can resize panes and select panes and windows
setw -g mouse-resize-pane on
setw -g mouse-select-pane on
setw -g mouse-select-window on

# -----------------------------------------------------------------------------
# Status bar
# -----------------------------------------------------------------------------

if-shell '[[ $solarized == light ]]' \
	'set -g status-style bg=white,bold,fg=default' \
	'set -g status-style bg=black,bold,fg=default'

set -g status-left " "
set -g status-right-length 13

if-shell '[[ $solarized == light ]]' \
	'set -g status-right "%d/%m #[fg=black]%R#[default]  "' \
	'set -g status-right "%d/%m #[fg=white]%R#[default]  "'

set -g window-status-format         '#I #W#F'
set -g window-status-current-format '#I #W#F'

# background windows look boring
set -g window-status-attr none
set -g window-status-fg   default
set -g window-status-bg   default

# highlight current window
set -g window-status-current-attr reverse
set -g window-status-current-bg   default
set -g window-status-current-fg   default

# highlight monitored windows
set -g window-status-bell-attr    none
set -g window-status-bell-fg      red
set -g window-status-content-attr none
set -g window-status-content-fg   blue

# message line
set -g message-attr         reverse
set -g message-bg           default
set -g message-fg           default

# :command line
set -g message-command-attr reverse
set -g message-command-bg   default
set -g message-command-fg   default
