#!/usr/bin/env fish

# Like `tee`, this reads from stdin and writes to both stdout and the clipboard.

function make_temp_file
    if command -s -q gmktemp
        gmktemp -t tbcopy.XXXXXXXX
    else
        mktemp -t tbcopy
    end
end

function main
    if command -s -q pbcopy
        set -l temp_file (make_temp_file); or return
        cat >$temp_file
        pbcopy <$temp_file
        cat $temp_file
    else if path is -w /dev/clipboard
        tee /dev/clipboard
    end
end

main
